@model IEnumerable<TrainingSystem.Domain.Trainer>

@{
    ViewData["Title"] = "Trainers";
}
<h1>@ViewBag.Title</h1>


    
    
<div class="mb-1">
    
    <p>
        <form class="mb-2" asp-action="Index" method="get">
            <div class="row align-items-center">
                <label class="ml-3" style="align-self:baseline " for="cars">Search By : </label>
                <select class="form-select form-control-sm mb-1 ml-2" name="SearchBy">
                     <option value="Name">Name</option>
                     <option value="Section">Section</option>
                     <option value="ID">ID</option>
                     <option value="Status">Status</option>
                </select>
            </div>
            <div class="row g-3 align-items-center">
                <input class="form-control form-control-sm col-3 ml-3" type="text" name="SearchValue" value="@ViewBag.SearchValue" id="SearchValue" />
                <input class="form-control form-control-sm col-1 ml-2" type="submit" value="Search"/>
                <a class=" ml-2" asp-action="Index">All Trainers</a>
            </div>
        </form>
        <a class="btn btn-success btn-sm" asp-action="Create">Add new trainer</a>
    <button id="btnGroupDrop1" type="button" class="btn btn-primary btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
      Export To
    </button>
    <ul class="dropdown-menu" aria-labelledby="btnGroupDrop1">
      <li><a class="dropdown-item" id="exportTableToExcel">Excel</a></li>
      <li><a class="dropdown-item" id="print">PDF</a></li>
    </ul>
    </p>
</div>

<table class="table mytable"id="mytable">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.ID)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.SectionID)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Status)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Email)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.ID)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.SectionID)
            </td>
            <td>
                    @{
                        var result = "";
                        @if (item.Status)
                        {
                            result = "Yes";
                        }
                        else { result = "No"; }
                      }
                     @result
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Email)
            </td>
            <td class="DontTakeInPDF" id="DontTakeInPDF">
                <a class="btn btn-primary btn-sm" asp-action="Edit" asp-route-id="@item.ID">Edit</a>
                
                <!-- 
                    <a asp-action="Details" asp-route-id="@item.ID">Details</a> |
                <a asp-action="Delete" asp-route-id="@item.ID">Delete</a>
                -->
            </td>
        </tr>
}
    </tbody>
</table>
@section scripts{
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/TableExport/5.2.0/js/tableexport.min.js" integrity="sha512-XmZS54be9JGMZjf+zk61JZaLZyjTRgs41JLSmx5QlIP5F+sSGIyzD2eJyxD4K6kGGr7AsVhaitzZ2WTfzpsQzg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>



<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdn.rawgit.com/rainabba/jquery-table2excel/1.1.0/dist/jquery.table2excel.min.js"></script>





<script>
    var ele2 = document.getElementById('mytable');
    console.log(ele2)
    
    //console.log(ele1)
    //
   $("#print").click(function(){
       var ele1 = document.querySelectorAll(".DontTakeInPDF").forEach(e => e.remove());
       var ele = document.getElementById('mytable');
       console.log(ele)
    html2pdf().from(ele).set({
    pagebreak: {avoid : 'tr'},
    filename:     'Trainers.pdf',
    jsPDF:{ orientation: 'landscape',unit: 'pt', format: 'letter', compressPDF: true }
    }).save()
    ele=ele2;
    setTimeout("location.reload(true);", 500);
   });
       
   $("#exportTableToExcel").click(function () {
       var ele1 = document.querySelectorAll(".DontTakeInPDF").forEach(e => e.remove());
       var ele = document.getElementById('mytable');
       $("#mytable").table2excel({
           filename: "Table",
           excepte: "DontTakeInPDF"
       });
       ele=ele2;
       setTimeout("location.reload(true);", 500);
   });
</script>
}


   

